(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7311:function(e,s,t){Promise.resolve().then(t.bind(t,97420))},97420:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return eU}});var a=t(57437),r=t(2265),l=t(7720),i=t(44839),n=t(96164);function d(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,n.m6)((0,i.W)(s))}let c=l.fC,o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.aV,{ref:s,className:d("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...r})});o.displayName=l.aV.displayName;let x=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.xz,{ref:s,className:d("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...r})});x.displayName=l.xz.displayName;let m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.VY,{ref:s,className:d("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});m.displayName=l.VY.displayName;let u=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:d("rounded-xl border bg-card text-card-foreground shadow",t),...r})});u.displayName="Card";let h=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:d("flex flex-col space-y-1.5 p-6",t),...r})});h.displayName="CardHeader";let f=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:d("font-semibold leading-none tracking-tight",t),...r})});f.displayName="CardTitle",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:d("text-sm text-muted-foreground",t),...r})}).displayName="CardDescription";let p=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:d("p-6 pt-0",t),...r})});p.displayName="CardContent";let g=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:d("flex items-center p-6 pt-0",t),...r})});g.displayName="CardFooter";var j=t(71538),v=t(13027);let N=(0,v.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),b=r.forwardRef((e,s)=>{let{className:t,variant:r,size:l,asChild:i=!1,...n}=e,c=i?j.g7:"button";return(0,a.jsx)(c,{className:d(N({variant:r,size:l,className:t})),ref:s,...n})});b.displayName="Button";let y=r.forwardRef((e,s)=>{let{className:t,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:d("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...l})});y.displayName="Input";var w=t(38837);let C=(0,v.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),S=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(w.f,{ref:s,className:d(C(),t),...r})});S.displayName=w.f.displayName;let R=(0,v.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function E(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:d(R({variant:t}),s),...r})}let k=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:s,className:d("w-full caption-bottom text-sm",t),...r})})});k.displayName="Table";let O=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("thead",{ref:s,className:d("[&_tr]:border-b",t),...r})});O.displayName="TableHeader";let A=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tbody",{ref:s,className:d("[&_tr:last-child]:border-0",t),...r})});A.displayName="TableBody",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tfoot",{ref:s,className:d("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r})}).displayName="TableFooter";let I=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tr",{ref:s,className:d("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r})});I.displayName="TableRow";let _=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("th",{ref:s,className:d("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r})});_.displayName="TableHead";let D=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("td",{ref:s,className:d("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r})});D.displayName="TableCell",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("caption",{ref:s,className:d("mt-4 text-sm text-muted-foreground",t),...r})}).displayName="TableCaption";var M=t(29234),V=t(74697);let P=M.fC,z=M.xz,K=M.h_;M.x8;let G=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(M.aV,{ref:s,className:d("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});G.displayName=M.aV.displayName;let Z=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsxs)(K,{children:[(0,a.jsx)(G,{}),(0,a.jsxs)(M.VY,{ref:s,className:d("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...l,children:[r,(0,a.jsxs)(M.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(V.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});Z.displayName=M.VY.displayName;let T=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:d("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};T.displayName="DialogHeader";let F=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:d("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};F.displayName="DialogFooter";let U=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(M.Dx,{ref:s,className:d("text-lg font-semibold leading-none tracking-tight",t),...r})});U.displayName=M.Dx.displayName;let W=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(M.dk,{ref:s,className:d("text-sm text-muted-foreground",t),...r})});W.displayName=M.dk.displayName;var B=t(1809),H=t(42421),L=t(14392),Y=t(22468);let q=B.fC;B.ZA;let J=B.B4,$=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsxs)(B.xz,{ref:s,className:d("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...l,children:[r,(0,a.jsx)(B.JO,{asChild:!0,children:(0,a.jsx)(H.Z,{className:"h-4 w-4 opacity-50"})})]})});$.displayName=B.xz.displayName;let Q=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(B.u_,{ref:s,className:d("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(L.Z,{className:"h-4 w-4"})})});Q.displayName=B.u_.displayName;let X=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(B.$G,{ref:s,className:d("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(H.Z,{className:"h-4 w-4"})})});X.displayName=B.$G.displayName;let ee=r.forwardRef((e,s)=>{let{className:t,children:r,position:l="popper",...i}=e;return(0,a.jsx)(B.h_,{children:(0,a.jsxs)(B.VY,{ref:s,className:d("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...i,children:[(0,a.jsx)(Q,{}),(0,a.jsx)(B.l_,{className:d("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(X,{})]})})});ee.displayName=B.VY.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(B.__,{ref:s,className:d("px-2 py-1.5 text-sm font-semibold",t),...r})}).displayName=B.__.displayName;let es=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsxs)(B.ck,{ref:s,className:d("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l,children:[(0,a.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(B.wU,{children:(0,a.jsx)(Y.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(B.eT,{children:r})]})});es.displayName=B.ck.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(B.Z0,{ref:s,className:d("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=B.Z0.displayName;var et=t(87816);let ea=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(et.fC,{className:d("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...r,ref:s,children:(0,a.jsx)(et.bU,{className:d("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});ea.displayName=et.fC.displayName;var er=t(45898);let el=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsxs)(er.fC,{ref:s,className:d("relative overflow-hidden",t),...l,children:[(0,a.jsx)(er.l_,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(ei,{}),(0,a.jsx)(er.Ns,{})]})});el.displayName=er.fC.displayName;let ei=r.forwardRef((e,s)=>{let{className:t,orientation:r="vertical",...l}=e;return(0,a.jsx)(er.gb,{ref:s,orientation:r,className:d("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...l,children:(0,a.jsx)(er.q4,{className:"relative flex-1 rounded-full bg-border"})})});ei.displayName=er.gb.displayName;var en=t(98960),ed=t(24241),ec=t(11240),eo=t(60090),ex=t(24258),em=t(14218),eu=t(88002),eh=t(92513),ef=t(10883),ep=t(95737),eg=t(56935),ej=t(35231),ev=t(92566),eN=t(2842),eb=t(9542),ey=t(85475),ew=t(20153),eC=t(16638),eS=t(25974),eR=t(28997);let eE="__NONE__",ek=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:2}).format(e||0),eO=e=>"".concat((null!=e?e:0).toFixed(2)," кг"),eA=(e,s)=>Math.random()*(s-e)+e,eI=()=>new Date().toISOString().slice(0,10),e_="fishing_products",eD="fishing_customers",eM="fishing_orders",eV="fishing_reservations",eP="fishing_settings";function ez(e,s){try{let t=JSON.parse(localStorage.getItem(e)||"null");return null!=t?t:s}catch(e){return s}}function eK(e,s){localStorage.setItem(e,JSON.stringify(s))}let eG=[{id:"p1",name:"Форель радужная",type:"GOOD",unit:"KG",isWeightable:!0,price:850,group:"Рыба",isActive:!0},{id:"p2",name:"Карп зеркальный",type:"GOOD",unit:"KG",isWeightable:!0,price:380,group:"Рыба",isActive:!0},{id:"p3",name:"Сом",type:"GOOD",unit:"KG",isWeightable:!0,price:620,group:"Рыба",isActive:!0},{id:"p4",name:"Входной билет",type:"SERVICE",unit:"PIECE",isWeightable:!1,price:400,group:"Вход",isActive:!0},{id:"p5",name:"Аренда беседки (час)",type:"SERVICE",unit:"HOUR",isWeightable:!1,price:500,group:"Беседки",isActive:!0},{id:"p6",name:"Мангал",type:"SERVICE",unit:"PIECE",isWeightable:!1,price:300,group:"Допы",isActive:!0},{id:"p7",name:"Уголь (3 кг)",type:"GOOD",unit:"PIECE",isWeightable:!1,price:260,group:"Допы",isActive:!0}],eZ=[{id:"c1",fullName:"Иван Петров",phone:"+7 900 000-00-01",tier:"Bronze",points:120},{id:"c2",fullName:"Анна Сидорова",phone:"+7 900 000-00-02",tier:"Silver",points:820}],eT=[{id:"g1",name:"Беседка №1",capacity:6,isActive:!0},{id:"g2",name:"Беседка №2",capacity:8,isActive:!0},{id:"g3",name:"Беседка №3",capacity:12,isActive:!0},{id:"g4",name:"Беседка №4",capacity:10,isActive:!0},{id:"g5",name:"Беседка №5",capacity:6,isActive:!0}],eF={weight:{rounding:.01,simulateScale:!0,port:"COM1",protocol:"AUTODETECT"},loyalty:{earnRate:.05,redeemRate:1,minOrderForEarn:300,tiers:{Bronze:0,Silver:1e4,Gold:3e4}}};function eU(){let[e,s]=(0,r.useState)(eG),[t,l]=(0,r.useState)(eZ),[i,n]=(0,r.useState)([]),[d,u]=(0,r.useState)([]),[h,f]=(0,r.useState)(eF),[p,g]=(0,r.useState)("pos");return(0,r.useEffect)(()=>{s(ez(e_,eG)),l(ez(eD,eZ)),n(ez(eM,[])),u(ez(eV,[])),f(ez(eP,eF))},[]),(0,r.useEffect)(()=>eK(e_,e),[e]),(0,r.useEffect)(()=>eK(eD,t),[t]),(0,r.useEffect)(()=>eK(eM,i),[i]),(0,r.useEffect)(()=>eK(eV,d),[d]),(0,r.useEffect)(()=>eK(eP,h),[h]),(0,r.useEffect)(()=>{console.assert(""!==String(eE),"Sentinel NONE must not be empty"),console.assert(eE==eE&&null===(eE==eE?null:eE),"Select mapping for NONE works")},[]),(0,a.jsxs)("div",{className:"p-4 md:p-6 space-y-4",children:[(0,a.jsxs)("header",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:"\uD83C\uDFA3 Fishing POS — MVP"}),(0,a.jsx)(E,{variant:"secondary",children:"RU"}),(0,a.jsx)("div",{className:"ml-auto text-sm text-muted-foreground",children:"Локальные данные (localStorage)"})]}),(0,a.jsxs)(c,{value:p,onValueChange:g,children:[(0,a.jsxs)(o,{className:"grid grid-cols-5 w-full",children:[(0,a.jsxs)(x,{value:"pos",className:"flex items-center gap-2",children:[(0,a.jsx)(en.Z,{className:"h-4 w-4"}),"POS"]}),(0,a.jsxs)(x,{value:"reservations",className:"flex items-center gap-2",children:[(0,a.jsx)(ed.Z,{className:"h-4 w-4"}),"Бронирования"]}),(0,a.jsxs)(x,{value:"crm",className:"flex items-center gap-2",children:[(0,a.jsx)(ec.Z,{className:"h-4 w-4"}),"CRM"]}),(0,a.jsxs)(x,{value:"reports",className:"flex items-center gap-2",children:[(0,a.jsx)(eo.Z,{className:"h-4 w-4"}),"Отчёты"]}),(0,a.jsxs)(x,{value:"admin",className:"flex items-center gap-2",children:[(0,a.jsx)(ex.Z,{className:"h-4 w-4"}),"Админ"]})]}),(0,a.jsx)(m,{value:"pos",children:(0,a.jsx)(eW,{products:e,settings:h,customers:t,setCustomers:l,onPaid:e=>n([e,...i])})}),(0,a.jsx)(m,{value:"reservations",children:(0,a.jsx)(eL,{gazebos:eT,customers:t,reservations:d,setReservations:u})}),(0,a.jsx)(m,{value:"crm",children:(0,a.jsx)(eY,{customers:t,setCustomers:l,orders:i})}),(0,a.jsx)(m,{value:"reports",children:(0,a.jsx)(eq,{orders:i,reservations:d,products:e})}),(0,a.jsx)(m,{value:"admin",children:(0,a.jsx)(e$,{products:e,setProducts:s,settings:h,setSettings:f})})]})]})}function eW(e){let{products:s,settings:t,customers:l,setCustomers:i,onPaid:n}=e,[d,c]=(0,r.useState)(""),[o,x]=(0,r.useState)([]),[m,j]=(0,r.useState)(t.weight.simulateScale),[v,N]=(0,r.useState)(0),[w,C]=(0,r.useState)(0),[R,M]=(0,r.useState)(null),[V,K]=(0,r.useState)(!1),G=e=>e===eE?null:e;(0,r.useEffect)(()=>{if(!m)return;let e=setInterval(()=>{let e=.6>Math.random()?eA(.9,2.2):0,s=0===e?0:eA(-.02,.02),a=t.weight.rounding||.01;N(Number((Math.round(Math.max(0,e+s)/a)*a).toFixed(2)))},800);return()=>clearInterval(e)},[m,t.weight.rounding]);let Z=(0,r.useMemo)(()=>s.filter(e=>e.isActive&&(e.name.toLowerCase().includes(d.toLowerCase())||(e.group||"").toLowerCase().includes(d.toLowerCase()))),[s,d]),T=(0,r.useMemo)(()=>{let e=o.reduce((e,s)=>e+(s.total||0),0),s=w/100*e;return{sub:e,disc:s,grand:e-s}},[o,w]);function F(e,s){x(o.map((t,a)=>{if(a!==e)return t;let r=Math.max(1,(t.qty||1)+s),l=t.weightKg?t.unitPrice*t.weightKg:t.unitPrice*r;return{...t,qty:r,total:l}}))}let U=Array.from(new Set(Z.map(e=>e.group))).filter(Boolean);return(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"md:col-span-2 space-y-4",children:[(0,a.jsxs)(u,{children:[(0,a.jsx)(h,{className:"pb-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y,{placeholder:"Поиск: товар/группа",value:d,onChange:e=>c(e.target.value)}),(0,a.jsxs)(E,{children:["Активно: ",Z.length]})]})}),(0,a.jsx)(p,{children:(0,a.jsx)(el,{className:"h-[360px] pr-2",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:[U.map(e=>(0,a.jsx)("div",{className:"col-span-full text-xs uppercase text-muted-foreground mt-2",children:e},e)),Z.map(e=>(0,a.jsxs)("button",{onClick:()=>(function(e){if(e.isWeightable){let s=Math.max(v,0);if(!s)return;let t=e.price*s;x([{productId:e.id,name:e.name,unitPrice:e.price,qty:1,weightKg:s,discountPct:0,total:t},...o])}else x([{productId:e.id,name:e.name,unitPrice:e.price,qty:1,weightKg:null,discountPct:0,total:e.price},...o])})(e),className:"text-left p-3 rounded-2xl border hover:shadow transition flex flex-col gap-1",children:[(0,a.jsx)("div",{className:"font-medium leading-tight",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.isWeightable?"".concat(ek(e.price)," / кг"):ek(e.price)}),(0,a.jsxs)("div",{className:"mt-auto flex items-center gap-2 text-xs",children:[e.isWeightable&&(0,a.jsxs)(E,{variant:"outline",className:"flex items-center gap-1",children:[(0,a.jsx)(em.Z,{className:"h-3 w-3"}),"весовой"]}),(0,a.jsx)(E,{variant:"SERVICE"===e.type?"secondary":"outline",children:"SERVICE"===e.type?"услуга":"товар"})]})]},e.id))]})})})]}),(0,a.jsxs)(u,{children:[(0,a.jsxs)(h,{className:"pb-2 flex flex-row items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(en.Z,{className:"h-5 w-5"}),(0,a.jsx)(f,{children:"Текущий чек"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(q,{value:null==R?eE:R,onValueChange:e=>M(G(e)),children:[(0,a.jsx)($,{className:"w-[260px]",children:(0,a.jsx)(J,{placeholder:"Клиент (опц.)"})}),(0,a.jsxs)(ee,{children:[(0,a.jsx)(es,{value:eE,children:"— Без клиента —"}),l.map(e=>(0,a.jsxs)(es,{value:e.id,children:[e.fullName," \xb7 ",e.phone," \xb7 ",e.tier," \xb7 ",e.points||0," б."]},e.id))]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(S,{className:"text-sm",children:"Скидка чека, %"}),(0,a.jsx)(y,{type:"number",className:"w-20",value:w,onChange:e=>C(Math.max(0,Number(e.target.value||0)))})]})]})]}),(0,a.jsx)(p,{children:0===o.length?(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Добавьте товары/услуги слева…"}):(0,a.jsxs)(k,{children:[(0,a.jsx)(O,{children:(0,a.jsxs)(I,{children:[(0,a.jsx)(_,{children:"Позиция"}),(0,a.jsx)(_,{className:"text-right",children:"Кол-во"}),(0,a.jsx)(_,{className:"text-right",children:"Вес"}),(0,a.jsx)(_,{className:"text-right",children:"Цена"}),(0,a.jsx)(_,{className:"text-right",children:"Скидка%"}),(0,a.jsx)(_,{className:"text-right",children:"Итого"}),(0,a.jsx)(_,{})]})}),(0,a.jsx)(A,{children:o.map((e,s)=>(0,a.jsxs)(I,{children:[(0,a.jsx)(D,{children:e.name}),(0,a.jsx)(D,{className:"text-right",children:e.weightKg?(0,a.jsx)(E,{variant:"outline",children:"1"}):(0,a.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,a.jsx)(b,{size:"icon",variant:"outline",onClick:()=>F(s,-1),children:(0,a.jsx)(eu.Z,{className:"h-3 w-3"})}),(0,a.jsx)("div",{className:"w-7 text-center",children:e.qty}),(0,a.jsx)(b,{size:"icon",variant:"outline",onClick:()=>F(s,1),children:(0,a.jsx)(eh.Z,{className:"h-3 w-3"})})]})}),(0,a.jsx)(D,{className:"text-right",children:e.weightKg?eO(e.weightKg):"—"}),(0,a.jsx)(D,{className:"text-right",children:ek(e.unitPrice)}),(0,a.jsx)(D,{className:"text-right",children:(0,a.jsx)(y,{type:"number",className:"w-20 ml-auto",value:e.discountPct,onChange:e=>{var t;return t=Math.max(0,Number(e.target.value||0)),void x(o.map((e,a)=>a!==s?e:{...e,discountPct:t,total:(e.weightKg?e.unitPrice*e.weightKg:e.unitPrice*e.qty)*(1-t/100)}))}})}),(0,a.jsx)(D,{className:"text-right font-medium",children:ek(e.total)}),(0,a.jsx)(D,{className:"text-right",children:(0,a.jsx)(b,{size:"icon",variant:"ghost",onClick:()=>{x(o.filter((e,t)=>t!==s))},children:(0,a.jsx)(ef.Z,{className:"h-4 w-4"})})})]},s))})]})}),(0,a.jsxs)(g,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Позиции: ",o.length]}),(0,a.jsxs)("div",{className:"text-right space-y-1",children:[(0,a.jsxs)("div",{className:"text-sm",children:["Подытог: ",(0,a.jsx)("span",{className:"font-medium",children:ek(T.sub)})]}),(0,a.jsxs)("div",{className:"text-sm",children:["Скидка чека: −",ek(T.disc)]}),(0,a.jsxs)("div",{className:"text-lg font-bold",children:["Итого к оплате: ",ek(T.grand)]}),(0,a.jsxs)(P,{open:V,onOpenChange:K,children:[(0,a.jsx)(z,{asChild:!0,children:(0,a.jsx)(b,{disabled:0===o.length,children:"Оплатить"})}),(0,a.jsx)(eH,{onCancel:()=>K(!1),onConfirm:e=>{K(!1),function(e){let s="o_".concat(Date.now()),a="POS-".concat(new Date().toISOString().slice(0,10).replaceAll("-",""),"-").concat(String(Math.floor(999*Math.random())).padStart(3,"0")),r=new Date().toISOString(),l={...T};if(R){let e=l.grand>=(t.loyalty.minOrderForEarn||0)?Math.floor(l.grand*(t.loyalty.earnRate||0)):0;i(s=>s.map(s=>s.id===R?{...s,points:(s.points||0)+e}:s))}n({id:s,number:a,items:o,payments:e,customerId:R,status:"PAID",createdAt:r,paidAt:r,totals:l}),x([]),C(0),M(null)}(e)},amount:T.grand,customerId:R,customers:l,setCustomers:i,settings:t})]})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(u,{children:[(0,a.jsxs)(h,{className:"pb-1 flex flex-row items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(em.Z,{className:"h-5 w-5"}),(0,a.jsx)(f,{children:"Весы"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(S,{children:"Симуляция"}),(0,a.jsx)(ea,{checked:m,onCheckedChange:j})]})]}),(0,a.jsxs)(p,{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-4xl font-bold tabular-nums",children:eO(v)}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Округление: ",t.weight.rounding.toFixed(2)," кг \xb7 Протокол: ",t.weight.protocol]}),(0,a.jsx)("div",{className:"text-sm",children:"Нажмите на весовой товар слева, чтобы добавить с текущим весом."})]})]}),(0,a.jsx)(eB,{})]})]})}function eB(){let[e,s]=(0,r.useState)([]);return(0,r.useEffect)(()=>{s(ez(eM,[]))},[]),(0,a.jsxs)(u,{children:[(0,a.jsx)(h,{className:"pb-2",children:(0,a.jsx)(f,{className:"text-base",children:"Последние продажи"})}),(0,a.jsx)(p,{children:(0,a.jsxs)("div",{className:"space-y-2 max-h-[220px] overflow-auto pr-2",children:[e.slice(0,8).map(e=>(0,a.jsxs)("div",{className:"p-2 rounded-xl border flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:e.number}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:new Date(e.paidAt).toLocaleString("ru-RU")})]}),(0,a.jsx)("div",{className:"text-sm font-semibold",children:ek(e.totals.grand)})]},e.id)),0===e.length&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Пока нет."})]})})]})}function eH(e){let{amount:s,onCancel:t,onConfirm:l,customerId:i,customers:n,setCustomers:d,settings:c}=e,[o,x]=(0,r.useState)(0),[m,u]=(0,r.useState)(s),[h,f]=(0,r.useState)(0),p=n.find(e=>e.id===i),g=p?Math.min((p.points||0)*(c.loyalty.redeemRate||1),s):0,j=Math.max(0,s-(o+m+h));return(0,a.jsxs)(Z,{children:[(0,a.jsxs)(T,{children:[(0,a.jsx)(U,{children:"Оплата"}),(0,a.jsxs)(W,{children:["Сумма к оплате: ",ek(s)]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ep.Z,{className:"h-4 w-4"}),(0,a.jsx)(S,{className:"w-32",children:"Наличные"}),(0,a.jsx)(y,{type:"number",value:o,onChange:e=>x(Number(e.target.value||0))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eg.Z,{className:"h-4 w-4"}),(0,a.jsx)(S,{className:"w-32",children:"Карта"}),(0,a.jsx)(y,{type:"number",value:m,onChange:e=>u(Number(e.target.value||0))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(S,{className:"w-32",children:"Баллы (₽)"}),(0,a.jsx)(y,{type:"number",value:h,onChange:e=>{f(Math.min(Math.max(0,Number(e.target.value||0)),g))}}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Доступно: ",ek(g)]})]}),(0,a.jsxs)("div",{className:"text-sm ".concat(0===j?"text-green-600":"text-amber-600"),children:["Остаток: ",ek(j)]})]}),(0,a.jsxs)(F,{children:[(0,a.jsx)(b,{variant:"outline",onClick:t,children:"Отмена"}),(0,a.jsx)(b,{disabled:0!==j,onClick:()=>{if(p&&h>0){let e=Math.ceil(h/(c.loyalty.redeemRate||1));d(s=>s.map(s=>s.id===p.id?{...s,points:Math.max(0,(s.points||0)-e)}:s))}l([o>0&&{method:"CASH",amount:o},m>0&&{method:"CARD",amount:m},h>0&&{method:"LOYALTY",amount:h}].filter(Boolean))},children:"Подтвердить"})]})]})}function eL(e){var s,t;let{gazebos:l,customers:i,reservations:n,setReservations:d}=e,[c,o]=(0,r.useState)(eI()),[x,m]=(0,r.useState)(null!==(t=null===(s=l[0])||void 0===s?void 0:s.id)&&void 0!==t?t:eE),g=Array.from({length:15},(e,s)=>s+8),j=(0,r.useMemo)(()=>x===eE?[]:n.filter(e=>e.startAt.slice(0,10)===c&&e.resourceId===x),[n,c,x]),v=e=>j.some(s=>s.startAt.slice(11,13)===String(e).padStart(2,"0"));return(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)(u,{className:"md:col-span-1",children:[(0,a.jsx)(h,{className:"pb-2",children:(0,a.jsx)(f,{children:"Параметры"})}),(0,a.jsxs)(p,{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{children:"Дата"}),(0,a.jsx)(y,{type:"date",value:c,onChange:e=>o(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{children:"Беседка"}),(0,a.jsxs)(q,{value:x,onValueChange:m,children:[(0,a.jsx)($,{children:(0,a.jsx)(J,{placeholder:"Выберите беседку"})}),(0,a.jsxs)(ee,{children:[(0,a.jsx)(es,{value:eE,children:"— Выберите беседку —"}),l.map(e=>(0,a.jsxs)(es,{value:e.id,children:[e.name," \xb7 ",e.capacity," мест"]},e.id))]})]})]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Клик по часу — забронировать/снять."})]})]}),(0,a.jsxs)(u,{className:"md:col-span-2",children:[(0,a.jsx)(h,{className:"pb-2",children:(0,a.jsx)(f,{children:"Слоты на день"})}),(0,a.jsx)(p,{children:(0,a.jsx)("div",{className:"grid grid-cols-3 md:grid-cols-5 lg:grid-cols-6 gap-2",children:g.map(e=>(0,a.jsxs)("button",{onClick:()=>(function(e){if(x===eE)return;let s=new Date("".concat(c,"T").concat(String(e).padStart(2,"0"),":00:00")).toISOString(),t=new Date("".concat(c,"T").concat(String(e+1).padStart(2,"0"),":00:00")).toISOString(),a=j.find(e=>e.startAt===s);if(a)d(n.filter(e=>e.id!==a.id));else{if(0===i.length)return;d([{id:"r_".concat(Date.now(),"_").concat(e),resourceId:x,customerId:i[0].id,status:"HELD",startAt:s,endAt:t,prepayAmount:0},...n])}})(e),disabled:x===eE,className:"rounded-2xl p-3 border text-left ".concat(x===eE?"opacity-50 cursor-not-allowed":v(e)?"bg-green-50 border-green-300":"hover:shadow"),children:[(0,a.jsxs)("div",{className:"text-sm font-medium",children:[String(e).padStart(2,"0"),":00 – ",String(e+1).padStart(2,"0"),":00"]}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:x===eE?"Выберите беседку":v(e)?"Забронировано":"Свободно"})]},e))})})]})]})}function eY(e){let{customers:s,setCustomers:t,orders:l}=e,[i,n]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[o,x]=(0,r.useState)(""),m=(0,r.useMemo)(()=>s.filter(e=>(e.fullName+" "+e.phone).toLowerCase().includes(i.toLowerCase())),[s,i]),g=(0,r.useMemo)(()=>{let e={};return l.forEach(s=>{var t;s.customerId&&(e[s.customerId]=(e[s.customerId]||0)+((null===(t=s.totals)||void 0===t?void 0:t.grand)||0))}),e},[l]);return(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)(u,{children:[(0,a.jsx)(h,{className:"pb-2",children:(0,a.jsx)(f,{children:"Добавить клиента"})}),(0,a.jsxs)(p,{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{children:"ФИО"}),(0,a.jsx)(y,{value:d,onChange:e=>c(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{children:"Телефон"}),(0,a.jsx)(y,{value:o,onChange:e=>x(e.target.value)})]}),(0,a.jsx)(b,{onClick:function(){d&&o&&(t([{id:"c_".concat(Date.now()),fullName:d,phone:o,tier:"Bronze",points:0},...s]),c(""),x(""))},children:"Сохранить"})]})]}),(0,a.jsxs)(u,{className:"md:col-span-2",children:[(0,a.jsxs)(h,{className:"pb-2 flex items-center justify-between",children:[(0,a.jsx)(f,{children:"Клиенты"}),(0,a.jsx)(y,{placeholder:"Поиск",value:i,onChange:e=>n(e.target.value),className:"w-64"})]}),(0,a.jsx)(p,{children:(0,a.jsxs)(k,{children:[(0,a.jsx)(O,{children:(0,a.jsxs)(I,{children:[(0,a.jsx)(_,{children:"ФИО"}),(0,a.jsx)(_,{children:"Телефон"}),(0,a.jsx)(_,{children:"Тир"}),(0,a.jsx)(_,{className:"text-right",children:"Баллы"}),(0,a.jsx)(_,{className:"text-right",children:"Потрачено"})]})}),(0,a.jsx)(A,{children:m.map(e=>(0,a.jsxs)(I,{children:[(0,a.jsx)(D,{children:e.fullName}),(0,a.jsx)(D,{children:e.phone}),(0,a.jsx)(D,{children:e.tier}),(0,a.jsx)(D,{className:"text-right",children:e.points||0}),(0,a.jsx)(D,{className:"text-right",children:ek(g[e.id]||0)})]},e.id))})]})})]})]})}function eq(e){let{orders:s,reservations:t,products:l}=e,i=(0,r.useMemo)(()=>{let e={};return s.forEach(s=>{var t,a;let r=(null===(t=s.paidAt)||void 0===t?void 0:t.slice(0,10))||s.createdAt.slice(0,10);e[r]=(e[r]||0)+((null===(a=s.totals)||void 0===a?void 0:a.grand)||0)}),Object.entries(e).sort((e,s)=>e[0].localeCompare(s[0])).map(e=>{let[s,t]=e;return{date:s,total:t}})},[s]),n=(0,r.useMemo)(()=>{let e={};return s.forEach(s=>s.items.forEach(s=>{e[s.name]=(e[s.name]||0)+(s.total||0)})),Object.entries(e).sort((e,s)=>s[1]-e[1]).slice(0,6).map(e=>{let[s,t]=e;return{name:s,amount:t}})},[s]);(0,r.useMemo)(()=>{let e={};return s.forEach(s=>s.items.forEach(s=>{let t=l.find(e=>e.id===s.productId);t&&t.isWeightable&&(e[t.name]=(e[t.name]||0)+(s.weightKg||0))})),Object.entries(e).map(e=>{let[s,t]=e;return{name:s,kg:Number(t.toFixed(2))}})},[s,l]),(0,r.useMemo)(()=>{let e={};return t.forEach(s=>{let t=s.startAt.slice(0,10);e[t]=(e[t]||0)+1}),Object.entries(e).map(e=>{let[s,t]=e;return{date:s,slots:t}})},[t]);let d=s.reduce((e,s)=>{var t;return e+((null===(t=s.totals)||void 0===t?void 0:t.grand)||0)},0),c=s.length?d/s.length:0;return(0,a.jsxs)("div",{className:"grid lg:grid-cols-2 gap-4",children:[(0,a.jsxs)(u,{children:[(0,a.jsx)(h,{className:"pb-2",children:(0,a.jsx)(f,{children:"Динамика выручки (по дням)"})}),(0,a.jsx)(p,{children:(0,a.jsx)("div",{className:"h-[240px]",children:(0,a.jsx)(ej.h,{width:"100%",height:"100%",children:(0,a.jsxs)(ev.w,{data:i,children:[(0,a.jsx)(eN.K,{dataKey:"date"}),(0,a.jsx)(eb.B,{}),(0,a.jsx)(ey.u,{}),(0,a.jsx)(ew.D,{}),(0,a.jsx)(eC.x,{type:"monotone",dataKey:"total",name:"Выручка"})]})})})})]}),(0,a.jsxs)(u,{children:[(0,a.jsx)(h,{className:"pb-2",children:(0,a.jsx)(f,{children:"Топ продаж (позиции)"})}),(0,a.jsx)(p,{children:(0,a.jsx)("div",{className:"h-[240px]",children:(0,a.jsx)(ej.h,{width:"100%",height:"100%",children:(0,a.jsxs)(eS.v,{data:n,children:[(0,a.jsx)(eN.K,{dataKey:"name",tick:{fontSize:12},interval:0,angle:-15,textAnchor:"end",height:60}),(0,a.jsx)(eb.B,{}),(0,a.jsx)(ey.u,{}),(0,a.jsx)(ew.D,{}),(0,a.jsx)(eR.$,{dataKey:"amount",name:"Продажи (₽)"})]})})})})]}),(0,a.jsxs)(u,{className:"lg:col-span-2",children:[(0,a.jsx)(h,{className:"pb-2",children:(0,a.jsx)(f,{children:"Итоги"})}),(0,a.jsxs)(p,{className:"grid md:grid-cols-4 gap-3",children:[(0,a.jsx)(eJ,{title:"Выручка",value:ek(d)}),(0,a.jsx)(eJ,{title:"Средний чек",value:ek(c)}),(0,a.jsx)(eJ,{title:"Чеков",value:s.length}),(0,a.jsx)(eJ,{title:"Бронирований",value:t.length})]})]})]})}function eJ(e){let{title:s,value:t}=e;return(0,a.jsxs)("div",{className:"rounded-2xl border p-4",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:s}),(0,a.jsx)("div",{className:"text-xl font-semibold mt-1",children:t})]})}function e$(e){let{products:s,setProducts:t,settings:l,setSettings:i}=e,[n,d]=(0,r.useState)(""),[c,o]=(0,r.useState)("Рыба"),[x,m]=(0,r.useState)("GOOD"),[g,j]=(0,r.useState)("KG"),[v,N]=(0,r.useState)(!0),[w,C]=(0,r.useState)(0);return(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)(u,{children:[(0,a.jsx)(h,{className:"pb-2",children:(0,a.jsx)(f,{children:"Новый товар/услуга"})}),(0,a.jsxs)(p,{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{children:"Название"}),(0,a.jsx)(y,{value:n,onChange:e=>d(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{children:"Группа"}),(0,a.jsxs)(q,{value:c,onValueChange:o,children:[(0,a.jsx)($,{children:(0,a.jsx)(J,{})}),(0,a.jsx)(ee,{children:["Рыба","Вход","Беседки","Допы"].map(e=>(0,a.jsx)(es,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{children:"Тип"}),(0,a.jsxs)(q,{value:x,onValueChange:e=>{m(e),"SERVICE"===e&&"KG"===g&&j("HOUR")},children:[(0,a.jsx)($,{children:(0,a.jsx)(J,{})}),(0,a.jsxs)(ee,{children:[(0,a.jsx)(es,{value:"GOOD",children:"GOOD"}),(0,a.jsx)(es,{value:"SERVICE",children:"SERVICE"})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{children:"Ед."}),(0,a.jsxs)(q,{value:g,onValueChange:e=>{j(e),N("KG"===e)},children:[(0,a.jsx)($,{children:(0,a.jsx)(J,{})}),(0,a.jsxs)(ee,{children:[(0,a.jsx)(es,{value:"KG",children:"KG"}),(0,a.jsx)(es,{value:"HOUR",children:"HOUR"}),(0,a.jsx)(es,{value:"PIECE",children:"PIECE"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{children:"Цена"}),(0,a.jsx)(y,{type:"number",value:w,onChange:e=>C(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ea,{checked:v,onCheckedChange:N,disabled:"KG"!==g}),(0,a.jsx)(S,{children:"Весовой товар"})]}),(0,a.jsx)(b,{onClick:function(){n&&(t([{id:"p_".concat(Date.now()),name:n,type:x,unit:g,isWeightable:v,price:Number(w||0),group:c,isActive:!0},...s]),d(""),C(0),N("KG"===g),m("GOOD"),o("Рыба"))},children:"Сохранить"})]})]}),(0,a.jsxs)(u,{className:"md:col-span-2",children:[(0,a.jsx)(h,{className:"pb-2",children:(0,a.jsx)(f,{children:"Номенклатура"})}),(0,a.jsx)(p,{children:(0,a.jsxs)(k,{children:[(0,a.jsx)(O,{children:(0,a.jsxs)(I,{children:[(0,a.jsx)(_,{children:"Название"}),(0,a.jsx)(_,{children:"Группа"}),(0,a.jsx)(_,{children:"Тип"}),(0,a.jsx)(_,{children:"Ед."}),(0,a.jsx)(_,{className:"text-right",children:"Цена"}),(0,a.jsx)(_,{className:"text-right",children:"Статус"})]})}),(0,a.jsx)(A,{children:s.map(e=>(0,a.jsxs)(I,{children:[(0,a.jsx)(D,{children:e.name}),(0,a.jsx)(D,{children:e.group||""}),(0,a.jsx)(D,{children:e.type}),(0,a.jsx)(D,{children:e.unit}),(0,a.jsx)(D,{className:"text-right",children:ek(e.price)}),(0,a.jsx)(D,{className:"text-right",children:(0,a.jsx)(b,{size:"sm",variant:e.isActive?"secondary":"outline",onClick:()=>{var a;return a=e.id,void t(s.map(e=>e.id===a?{...e,isActive:!e.isActive}:e))},children:e.isActive?"Активен":"Откл."})})]},e.id))})]})})]}),(0,a.jsxs)(u,{className:"md:col-span-3",children:[(0,a.jsx)(h,{className:"pb-2",children:(0,a.jsx)(f,{children:"Настройки"})}),(0,a.jsxs)(p,{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"rounded-2xl border p-3 space-y-2",children:[(0,a.jsx)("div",{className:"font-medium",children:"Весы"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 items-center",children:[(0,a.jsx)(S,{children:"Округление (кг)"}),(0,a.jsx)(y,{type:"number",step:"0.01",value:l.weight.rounding,onChange:e=>i({...l,weight:{...l.weight,rounding:Number(e.target.value||.01)}})}),(0,a.jsx)(S,{children:"Протокол"}),(0,a.jsxs)(q,{value:l.weight.protocol,onValueChange:e=>i({...l,weight:{...l.weight,protocol:e}}),children:[(0,a.jsx)($,{children:(0,a.jsx)(J,{})}),(0,a.jsx)(ee,{children:["AUTODETECT","RS232","TCPIP"].map(e=>(0,a.jsx)(es,{value:e,children:e},e))})]}),(0,a.jsx)(S,{children:"Симуляция"}),(0,a.jsx)(ea,{checked:l.weight.simulateScale,onCheckedChange:e=>i({...l,weight:{...l.weight,simulateScale:e}})})]})]}),(0,a.jsxs)("div",{className:"rounded-2xl border p-3 space-y-2",children:[(0,a.jsx)("div",{className:"font-medium",children:"Лояльность"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 items-center",children:[(0,a.jsx)(S,{children:"Earn rate"}),(0,a.jsx)(y,{type:"number",step:"0.01",value:l.loyalty.earnRate,onChange:e=>i({...l,loyalty:{...l.loyalty,earnRate:Number(e.target.value||0)}})}),(0,a.jsx)(S,{children:"Redeem ₽/балл"}),(0,a.jsx)(y,{type:"number",value:l.loyalty.redeemRate,onChange:e=>i({...l,loyalty:{...l.loyalty,redeemRate:Number(e.target.value||1)}})}),(0,a.jsx)(S,{children:"Мин. чек для earn"}),(0,a.jsx)(y,{type:"number",value:l.loyalty.minOrderForEarn,onChange:e=>i({...l,loyalty:{...l.loyalty,minOrderForEarn:Number(e.target.value||0)}})})]})]}),(0,a.jsxs)("div",{className:"rounded-2xl border p-3 space-y-2",children:[(0,a.jsx)("div",{className:"font-medium",children:"Прочее"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Версия демо-интерфейса без сервера. Все данные в браузере."})]})]})]})]})}}},function(e){e.O(0,[427,971,23,744],function(){return e(e.s=7311)}),_N_E=e.O()}]);